<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="LUMORA - Advanced AI Assistant powered by Cohere & Firebase" />
  <title>LUMORA - Advanced AI Assistant</title>

  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />

  <!-- Firebase SDKs -->
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-storage-compat.js"></script>

  <style>
    :root {
      /* Light theme variables */
      --bg-light: #f8faff;
      --card-light: #ffffff;
      --text-light: #1e293b;
      --muted-light: #64748b;
      --accent1-light: #6e48aa;
      --accent2-light: #4776E6;
      --glass-light: rgba(255, 255, 255, 0.7);
      --shadow-light: 0 10px 30px rgba(0, 0, 0, 0.08);
      
      /* Dark theme variables */
      --bg-dark: #0f1724;
      --card-dark: #0b1220;
      --text-dark: #e6eef8;
      --muted-dark: #94a3b8;
      --accent1-dark: #6e48aa;
      --accent2-dark: #4776E6;
      --glass-dark: rgba(255, 255, 255, 0.04);
      --shadow-dark: 0 10px 30px rgba(2, 6, 23, 0.6);
      
      /* Common variables */
      --radius: 14px;
      --transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
      --success: #10b981;
      --danger: #ef4444;
      
      /* Default to dark theme */
      --bg: var(--bg-dark);
      --card: var(--card-dark);
      --text: var(--text-dark);
      --muted: var(--muted-dark);
      --accent1: var(--accent1-dark);
      --accent2: var(--accent2-dark);
      --glass: var(--glass-dark);
      --shadow: var(--shadow-dark);
    }

    [data-theme="light"] {
      --bg: var(--bg-light);
      --card: var(--card-light);
      --text: var(--text-light);
      --muted: var(--muted-light);
      --accent1: var(--accent1-light);
      --accent2: var(--accent2-light);
      --glass: var(--glass-light);
      --shadow: var(--shadow-light);
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    html, body {
      height: 100%;
      transition: var(--transition);
    }

    body {
      font-family: 'Inter', ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      background: var(--bg);
      color: var(--text);
      -webkit-font-smoothing: antialiased;
      display: flex;
      flex-direction: column;
      min-height: 100vh;
      overflow-x: hidden;
      position: relative;
    }

    /* Animated background elements */
    .bg-blob {
      position: fixed;
      width: 500px;
      height: 500px;
      border-radius: 50%;
      filter: blur(80px);
      opacity: 0.15;
      z-index: -1;
      animation: float 20s ease-in-out infinite;
    }

    .blob-1 {
      background: var(--accent1);
      top: -200px;
      left: -200px;
      animation-delay: 0s;
    }

    .blob-2 {
      background: var(--accent2);
      bottom: -150px;
      right: -150px;
      animation-delay: -7s;
    }

    @keyframes float {
      0%, 100% {
        transform: translate(0, 0) scale(1);
      }
      33% {
        transform: translate(30px, -30px) scale(1.05);
      }
      66% {
        transform: translate(-20px, 20px) scale(0.95);
      }
    }

    /* Loading screen */
    #loading-screen {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: var(--bg);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      z-index: 9999;
      transition: opacity 0.5s ease, visibility 0.5s;
    }

    .loading-logo {
      width: 80px;
      height: 80px;
      margin-bottom: 20px;
      position: relative;
    }

    .loading-logo-inner {
      width: 100%;
      height: 100%;
      background: linear-gradient(135deg, var(--accent2), var(--accent1));
      border-radius: 20px;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-weight: 800;
      font-size: 32px;
      box-shadow: 0 8px 30px rgba(78, 52, 175, 0.25);
      animation: pulse 2s ease-in-out infinite;
    }

    @keyframes pulse {
      0%, 100% {
        transform: scale(1);
        opacity: 1;
      }
      50% {
        transform: scale(1.05);
        opacity: 0.8;
      }
    }

    .loading-bar {
      width: 200px;
      height: 4px;
      background: rgba(255, 255, 255, 0.1);
      border-radius: 4px;
      overflow: hidden;
      position: relative;
    }

    .loading-progress {
      position: absolute;
      height: 100%;
      width: 0%;
      background: linear-gradient(90deg, var(--accent2), var(--accent1));
      border-radius: 4px;
      animation: loading 2s ease-in-out forwards;
    }

    @keyframes loading {
      0% { width: 0%; }
      100% { width: 100%; }
    }

    /* Top bar */
    header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 18px 28px;
      background: transparent;
      position: relative;
      z-index: 10;
    }

    .brand {
      display: flex;
      gap: 12px;
      align-items: center;
    }

    .brand .logo {
      width: 46px;
      height: 46px;
      border-radius: 12px;
      background: linear-gradient(135deg, var(--accent2), var(--accent1));
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 800;
      color: white;
      box-shadow: 0 8px 30px rgba(78, 52, 175, 0.25);
      position: relative;
      overflow: hidden;
    }

    .logo::after {
      content: "";
      position: absolute;
      top: -50%;
      left: -50%;
      width: 200%;
      height: 200%;
      background: linear-gradient(
        to bottom right,
        rgba(255, 255, 255, 0.2),
        rgba(255, 255, 255, 0)
      );
      transform: rotate(30deg);
    }

    .brand h1 {
      font-size: 18px;
      letter-spacing: 0.6px;
      background: linear-gradient(90deg, var(--accent2), var(--accent1));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .top-actions {
      display: flex;
      gap: 10px;
      align-items: center;
    }

    .theme-toggle {
      width: 48px;
      height: 48px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      background: var(--glass);
      border: 1px solid rgba(255, 255, 255, 0.06);
      cursor: pointer;
      transition: var(--transition);
      backdrop-filter: blur(10px);
    }

    .theme-toggle:hover {
      transform: rotate(15deg);
      box-shadow: var(--shadow);
    }

    .btn {
      padding: 12px 20px;
      border-radius: 12px;
      border: none;
      cursor: pointer;
      font-weight: 600;
      transition: var(--transition);
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .btn-primary {
      background: linear-gradient(90deg, var(--accent2), var(--accent1));
      color: white;
      box-shadow: var(--shadow);
    }

    .btn-primary:hover {
      transform: translateY(-2px);
      box-shadow: 0 15px 35px rgba(78, 52, 175, 0.3);
    }

    .btn-ghost {
      background: transparent;
      border: 1px solid rgba(255, 255, 255, 0.06);
      color: var(--text);
    }

    .btn-ghost:hover {
      background: var(--glass);
      border-color: rgba(255, 255, 255, 0.1);
    }

    /* Auth container */
    .auth-container {
      display: flex;
      flex: 1;
      align-items: center;
      justify-content: center;
      padding: 20px;
      position: relative;
      z-index: 5;
    }

    .auth-card {
      width: 100%;
      max-width: 440px;
      background: var(--card);
      border-radius: var(--radius);
      padding: 32px;
      box-shadow: var(--shadow);
      border: 1px solid rgba(255, 255, 255, 0.03);
      backdrop-filter: blur(10px);
      transform-style: preserve-3d;
      perspective: 1000px;
      position: relative;
      overflow: hidden;
    }

    .auth-card::before {
      content: "";
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 5px;
      background: linear-gradient(90deg, var(--accent2), var(--accent1));
    }

    .auth-header {
      text-align: center;
      margin-bottom: 30px;
    }

    .auth-logo {
      width: 60px;
      height: 60px;
      border-radius: 16px;
      background: linear-gradient(135deg, var(--accent2), var(--accent1));
      display: flex;
      align-items: center;
      justify-content: center;
      margin: 0 auto 15px;
      color: white;
      font-weight: 800;
      font-size: 24px;
      box-shadow: 0 8px 20px rgba(78, 52, 175, 0.3);
    }

    .auth-title {
      font-size: 24px;
      font-weight: 700;
      margin-bottom: 8px;
      background: linear-gradient(90deg, var(--accent2), var(--accent1));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .auth-subtitle {
      color: var(--muted);
      font-size: 14px;
    }

    .auth-form {
      display: flex;
      flex-direction: column;
      gap: 18px;
    }

    .form-group {
      position: relative;
    }

    .form-input {
      width: 100%;
      padding: 16px 18px;
      border-radius: 12px;
      border: 1px solid rgba(255, 255, 255, 0.06);
      background: var(--glass);
      color: var(--text);
      font-size: 15px;
      transition: var(--transition);
    }

    .form-input:focus {
      outline: none;
      border-color: var(--accent1);
      box-shadow: 0 0 0 3px rgba(110, 72, 170, 0.2);
    }

    .form-input::placeholder {
      color: var(--muted);
    }

    .password-toggle {
      position: absolute;
      right: 15px;
      top: 50%;
      transform: translateY(-50%);
      color: var(--muted);
      cursor: pointer;
      transition: var(--transition);
    }

    .password-toggle:hover {
      color: var(--accent1);
    }

    .form-options {
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-size: 14px;
    }

    .remember-me {
      display: flex;
      align-items: center;
      gap: 8px;
      color: var(--muted);
    }

    .checkbox {
      appearance: none;
      -webkit-appearance: none;
      width: 18px;
      height: 18px;
      border-radius: 4px;
      border: 1px solid rgba(255, 255, 255, 0.1);
      background: var(--glass);
      cursor: pointer;
      position: relative;
      transition: var(--transition);
    }

    .checkbox:checked {
      background: linear-gradient(90deg, var(--accent2), var(--accent1));
      border-color: transparent;
    }

    .checkbox:checked::after {
      content: "✓";
      position: absolute;
      color: white;
      font-size: 12px;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
    }

    .forgot-link {
      color: var(--accent2);
      text-decoration: none;
      transition: var(--transition);
      cursor: pointer;
    }

    .forgot-link:hover {
      color: var(--accent1);
      text-decoration: underline;
    }

    .submit-btn {
      padding: 16px;
      border-radius: 12px;
      border: none;
      background: linear-gradient(90deg, var(--accent2), var(--accent1));
      color: white;
      font-weight: 600;
      font-size: 16px;
      cursor: pointer;
      transition: var(--transition);
      margin-top: 10px;
      position: relative;
      overflow: hidden;
    }

    .submit-btn::before {
      content: "";
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
      transition: 0.5s;
    }

    .submit-btn:hover::before {
      left: 100%;
    }

    .submit-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 10px 25px rgba(78, 52, 175, 0.3);
    }

    .submit-btn:active {
      transform: translateY(0);
    }

    .auth-switch {
      text-align: center;
      margin-top: 25px;
      color: var(--muted);
      font-size: 14px;
    }

    .switch-link {
      color: var(--accent2);
      cursor: pointer;
      font-weight: 600;
      transition: var(--transition);
    }

    .switch-link:hover {
      color: var(--accent1);
      text-decoration: underline;
    }

    .auth-footer {
      text-align: center;
      margin-top: 30px;
      padding-top: 20px;
      border-top: 1px solid rgba(255, 255, 255, 0.03);
      color: var(--muted);
      font-size: 13px;
    }

    .powered-by {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 5px;
    }

    /* Form states */
    .form-success {
      background: rgba(16, 185, 129, 0.1);
      border: 1px solid rgba(16, 185, 129, 0.2);
      color: var(--success);
      padding: 12px 16px;
      border-radius: 8px;
      margin-bottom: 15px;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .form-error {
      background: rgba(239, 68, 68, 0.1);
      border: 1px solid rgba(239, 68, 68, 0.2);
      color: var(--danger);
      padding: 12px 16px;
      border-radius: 8px;
      margin-bottom: 15px;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    /* Animation classes */
    .slide-in {
      animation: slideIn 0.5s ease-out forwards;
    }

    .slide-out {
      animation: slideOut 0.5s ease-in forwards;
    }

    @keyframes slideIn {
      from {
        opacity: 0;
        transform: translateY(20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    @keyframes slideOut {
      from {
        opacity: 1;
        transform: translateY(0);
      }
      to {
        opacity: 0;
        transform: translateY(-20px);
      }
    }

    .fade-in {
      animation: fadeIn 0.5s ease-out forwards;
    }

    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }

    /* Toast notification */
    .toast {
      position: fixed;
      bottom: 24px;
      right: 24px;
      background: var(--card);
      color: var(--text);
      padding: 16px 20px;
      border-radius: 12px;
      box-shadow: var(--shadow);
      border: 1px solid rgba(255, 255, 255, 0.03);
      display: flex;
      align-items: center;
      gap: 12px;
      z-index: 1000;
      transform: translateY(100px);
      opacity: 0;
      transition: all 0.3s cubic-bezier(0.68, -0.55, 0.27, 1.55);
      max-width: 350px;
    }

    .toast.show {
      transform: translateY(0);
      opacity: 1;
    }

    .toast-success {
      border-left: 4px solid var(--success);
    }

    .toast-error {
      border-left: 4px solid var(--danger);
    }

    .toast-icon {
      font-size: 20px;
    }

    .toast-success .toast-icon {
      color: var(--success);
    }

    .toast-error .toast-icon {
      color: var(--danger);
    }

    .toast-content {
      flex: 1;
    }

    .toast-title {
      font-weight: 600;
      margin-bottom: 4px;
    }

    .toast-message {
      font-size: 14px;
      color: var(--muted);
    }

    .toast-close {
      background: none;
      border: none;
      color: var(--muted);
      cursor: pointer;
      font-size: 16px;
      transition: var(--transition);
    }

    .toast-close:hover {
      color: var(--text);
    }

    footer {
      padding: 18px;
      text-align: center;
      color: var(--muted);
      font-size: 13px;
      position: relative;
      z-index: 5;
    }

    /* Responsive */
    @media (max-width: 768px) {
      .auth-card {
        padding: 24px;
      }
      
      .bg-blob {
        width: 300px;
        height: 300px;
      }
    }

    @media (max-width: 480px) {
      header {
        padding: 15px;
      }
      
      .auth-card {
        padding: 20px;
      }
      
      .form-options {
        flex-direction: column;
        align-items: flex-start;
        gap: 10px;
      }
    }
  </style>
</head>
<body>
  <!-- Loading screen -->
  <div id="loading-screen" class="fade-in">
    <div class="loading-logo">
      <div class="loading-logo-inner">L</div>
    </div>
    <div class="loading-bar">
      <div class="loading-progress"></div>
    </div>
  </div>

  <!-- Animated background elements -->
  <div class="bg-blob blob-1"></div>
  <div class="bg-blob blob-2"></div>

  <header>
    <div class="brand">
      <div class="logo">L</div>
      <div>
        <h1>LUMORA</h1>
        <div class="small">Advanced AI Assistant</div>
      </div>
    </div>

    <div class="top-actions">
      <button class="theme-toggle" id="theme-toggle" aria-label="Toggle dark/light mode">
        <i class="fas fa-moon"></i>
      </button>
      <button class="btn btn-ghost" id="btn-register">Register</button>
      <button class="btn btn-primary" id="btn-login">Login</button>
    </div>
  </header>

  <main class="auth-container">
    <div class="auth-card slide-in" id="auth-card">
      <div class="auth-header">
        <div class="auth-logo">L</div>
        <h2 class="auth-title" id="auth-title">Welcome to LUMORA</h2>
        <p class="auth-subtitle" id="auth-subtitle">Sign in to access your AI assistant</p>
      </div>

      <div id="auth-forms">
        <!-- Login form by default -->
        <form class="auth-form" id="login-form">
          <div class="form-group">
            <input type="email" class="form-input" id="login-email" placeholder="Email address" required>
          </div>
          <div class="form-group">
            <input type="password" class="form-input" id="login-password" placeholder="Password" required>
            <span class="password-toggle" id="login-password-toggle">
              <i class="far fa-eye"></i>
            </span>
          </div>
          <div class="form-options">
            <label class="remember-me">
              <input type="checkbox" class="checkbox" id="remember-me">
              Remember me
            </label>
            <span class="forgot-link" id="forgot-password-link">Forgot password?</span>
          </div>
          <button type="submit" class="submit-btn" id="login-submit">
            <span>Sign In</span>
            <i class="fas fa-arrow-right"></i>
          </button>
        </form>
      </div>

      <div class="auth-switch" id="auth-switch">
        <span>Don't have an account? </span>
        <span class="switch-link" id="switch-to-register">Create account</span>
      </div>

      <div class="auth-footer">
        <div class="powered-by">
          <span>From Novera</span>
          <span>•</span>
          <span>Powered by AITECH</span>
        </div>
      </div>
    </div>
  </main>

  <footer>From AITECH by ANOINTING • Powered by Cohere AI • © 2023–2025 LUMORA</footer>

  <!-- Toast notification -->
  <div class="toast" id="toast">
    <div class="toast-icon">
      <i class="fas fa-check-circle"></i>
    </div>
    <div class="toast-content">
      <div class="toast-title" id="toast-title">Success</div>
      <div class="toast-message" id="toast-message">Operation completed successfully</div>
    </div>
    <button class="toast-close" id="toast-close">
      <i class="fas fa-times"></i>
    </button>
  </div>

  <script>
    // --------- CONFIG ----------
    const COHERE_API_KEY = "NMGQyIAUHmb861NWLZW2iDHik3Vui8No6dLxj7Gs"; // user-provided

    const firebaseConfig = {
      apiKey: "AIzaSyBOwdgpt4PSo_MLMmz716zswPnpInaXfok",
      authDomain: "lumora-b227c.firebaseapp.com",
      projectId: "lumora-b227c",
      storageBucket: "lumora-b227c.firebasestorage.app",
      messagingSenderId: "126529099616",
      appId: "1:126529099616:web:303e8d8c987ecd6ba1b005",
      measurementId: "G-83DKQ20SV8"
    };

    // Initialize Firebase
    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();
    const db = firebase.firestore();
    const storage = firebase.storage();

    // --------- ELEMENTS ----------
    const loadingScreen = document.getElementById('loading-screen');
    const themeToggle = document.getElementById('theme-toggle');
    const btnLogin = document.getElementById('btn-login');
    const btnRegister = document.getElementById('btn-register');
    const authCard = document.getElementById('auth-card');
    const authTitle = document.getElementById('auth-title');
    const authSubtitle = document.getElementById('auth-subtitle');
    const authForms = document.getElementById('auth-forms');
    const authSwitch = document.getElementById('auth-switch');
    const switchToRegister = document.getElementById('switch-to-register');
    const forgotPasswordLink = document.getElementById('forgot-password-link');
    const loginForm = document.getElementById('login-form');
    const loginPasswordToggle = document.getElementById('login-password-toggle');
    const toast = document.getElementById('toast');
    const toastTitle = document.getElementById('toast-title');
    const toastMessage = document.getElementById('toast-message');
    const toastClose = document.getElementById('toast-close');

    // --------- STATE ----------
    let currentAuthView = 'login';

    // --------- THEME MANAGEMENT ----------
    function initTheme() {
      const savedTheme = localStorage.getItem('theme') || 'dark';
      document.documentElement.setAttribute('data-theme', savedTheme);
      updateThemeIcon(savedTheme);
    }

    function updateThemeIcon(theme) {
      const icon = themeToggle.querySelector('i');
      if (theme === 'light') {
        icon.classList.remove('fa-moon');
        icon.classList.add('fa-sun');
      } else {
        icon.classList.remove('fa-sun');
        icon.classList.add('fa-moon');
      }
    }

    themeToggle.addEventListener('click', () => {
      const currentTheme = document.documentElement.getAttribute('data-theme');
      const newTheme = currentTheme === 'light' ? 'dark' : 'light';
      
      document.documentElement.setAttribute('data-theme', newTheme);
      localStorage.setItem('theme', newTheme);
      updateThemeIcon(newTheme);
    });

    // --------- LOADING SCREEN ----------
    function hideLoadingScreen() {
      loadingScreen.style.opacity = '0';
      setTimeout(() => {
        loadingScreen.style.display = 'none';
      }, 500);
    }

    // Simulate loading process
    setTimeout(hideLoadingScreen, 2500);

    // --------- PASSWORD TOGGLE ----------
    loginPasswordToggle.addEventListener('click', () => {
      const passwordInput = document.getElementById('login-password');
      const icon = loginPasswordToggle.querySelector('i');
      
      if (passwordInput.type === 'password') {
        passwordInput.type = 'text';
        icon.classList.remove('fa-eye');
        icon.classList.add('fa-eye-slash');
      } else {
        passwordInput.type = 'password';
        icon.classList.remove('fa-eye-slash');
        icon.classList.add('fa-eye');
      }
    });

    // --------- TOAST NOTIFICATIONS ----------
    function showToast(title, message, type = 'success') {
      // Set toast content
      toastTitle.textContent = title;
      toastMessage.textContent = message;
      
      // Set toast type
      toast.className = 'toast';
      toast.classList.add(`toast-${type}`);
      
      // Show toast
      toast.classList.add('show');
      
      // Auto hide after 5 seconds
      setTimeout(() => {
        hideToast();
      }, 5000);
    }

    function hideToast() {
      toast.classList.remove('show');
    }

    toastClose.addEventListener('click', hideToast);

    // --------- AUTH VIEW MANAGEMENT ----------
    function setAuthView(view) {
      // Slide out current view
      authCard.classList.remove('slide-in');
      authCard.classList.add('slide-out');
      
      setTimeout(() => {
        currentAuthView = view;
        
        // Update based on view
        switch (view) {
          case 'login':
            renderLoginView();
            break;
          case 'register':
            renderRegisterView();
            break;
          case 'forgot':
            renderForgotView();
            break;
        }
        
        // Slide in new view
        authCard.classList.remove('slide-out');
        authCard.classList.add('slide-in');
      }, 300);
    }

    function renderLoginView() {
      authTitle.textContent = 'Welcome to LUMORA';
      authSubtitle.textContent = 'Sign in to access your AI assistant';
      
      authForms.innerHTML = `
        <form class="auth-form" id="login-form">
          <div class="form-group">
            <input type="email" class="form-input" id="login-email" placeholder="Email address" required>
          </div>
          <div class="form-group">
            <input type="password" class="form-input" id="login-password" placeholder="Password" required>
            <span class="password-toggle" id="login-password-toggle">
              <i class="far fa-eye"></i>
            </span>
          </div>
          <div class="form-options">
            <label class="remember-me">
              <input type="checkbox" class="checkbox" id="remember-me">
              Remember me
            </label>
            <span class="forgot-link" id="forgot-password-link">Forgot password?</span>
          </div>
          <button type="submit" class="submit-btn" id="login-submit">
            <span>Sign In</span>
            <i class="fas fa-arrow-right"></i>
          </button>
        </form>
      `;
      
      authSwitch.innerHTML = `
        <span>Don't have an account? </span>
        <span class="switch-link" id="switch-to-register">Create account</span>
      `;
      
      // Reattach event listeners
      document.getElementById('login-password-toggle').addEventListener('click', function() {
        const passwordInput = document.getElementById('login-password');
        const icon = this.querySelector('i');
        
        if (passwordInput.type === 'password') {
          passwordInput.type = 'text';
          icon.classList.remove('fa-eye');
          icon.classList.add('fa-eye-slash');
        } else {
          passwordInput.type = 'password';
          icon.classList.remove('fa-eye-slash');
          icon.classList.add('fa-eye');
        }
      });
      
      document.getElementById('forgot-password-link').addEventListener('click', () => {
        setAuthView('forgot');
      });
      
      document.getElementById('switch-to-register').addEventListener('click', () => {
        setAuthView('register');
      });
      
      document.getElementById('login-form').addEventListener('submit', handleLogin);
    }

    function renderRegisterView() {
      authTitle.textContent = 'Create Account';
      authSubtitle.textContent = 'Join LUMORA to unlock AI capabilities';
      
      authForms.innerHTML = `
        <form class="auth-form" id="register-form">
          <div class="form-group">
            <input type="text" class="form-input" id="register-name" placeholder="Full name" required>
          </div>
          <div class="form-group">
            <input type="email" class="form-input" id="register-email" placeholder="Email address" required>
          </div>
          <div class="form-group">
            <input type="password" class="form-input" id="register-password" placeholder="Password (min. 6 characters)" required>
            <span class="password-toggle" id="register-password-toggle">
              <i class="far fa-eye"></i>
            </span>
          </div>
          <div class="form-group">
            <input type="password" class="form-input" id="register-confirm" placeholder="Confirm password" required>
          </div>
          <button type="submit" class="submit-btn" id="register-submit">
            <span>Create Account</span>
            <i class="fas fa-user-plus"></i>
          </button>
        </form>
      `;
      
      authSwitch.innerHTML = `
        <span>Already have an account? </span>
        <span class="switch-link" id="switch-to-login">Sign in</span>
      `;
      
      // Reattach event listeners
      document.getElementById('register-password-toggle').addEventListener('click', function() {
        const passwordInput = document.getElementById('register-password');
        const icon = this.querySelector('i');
        
        if (passwordInput.type === 'password') {
          passwordInput.type = 'text';
          icon.classList.remove('fa-eye');
          icon.classList.add('fa-eye-slash');
        } else {
          passwordInput.type = 'password';
          icon.classList.remove('fa-eye-slash');
          icon.classList.add('fa-eye');
        }
      });
      
      document.getElementById('switch-to-login').addEventListener('click', () => {
        setAuthView('login');
      });
      
      document.getElementById('register-form').addEventListener('submit', handleRegister);
    }

    function renderForgotView() {
      authTitle.textContent = 'Reset Password';
      authSubtitle.textContent = 'Enter your email to receive a reset link';
      
      authForms.innerHTML = `
        <form class="auth-form" id="forgot-form">
          <div class="form-group">
            <input type="email" class="form-input" id="forgot-email" placeholder="Email address" required>
          </div>
          <button type="submit" class="submit-btn" id="forgot-submit">
            <span>Send Reset Link</span>
            <i class="fas fa-paper-plane"></i>
          </button>
        </form>
      `;
      
      authSwitch.innerHTML = `
        <span>Remember your password? </span>
        <span class="switch-link" id="switch-to-login">Back to login</span>
      `;
      
      document.getElementById('switch-to-login').addEventListener('click', () => {
        setAuthView('login');
      });
      
      document.getElementById('forgot-form').addEventListener('submit', handleForgotPassword);
    }

    // --------- AUTH HANDLERS ----------
    function handleLogin(e) {
      e.preventDefault();
      
      const email = document.getElementById('login-email').value;
      const password = document.getElementById('login-password').value;
      const submitBtn = document.getElementById('login-submit');
      
      // Show loading state
      const originalText = submitBtn.innerHTML;
      submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Signing in...';
      submitBtn.disabled = true;
      
      auth.signInWithEmailAndPassword(email, password)
        .then((userCredential) => {
          const user = userCredential.user;
          
          if (!user.emailVerified) {
            // Show email verification reminder
            showToast('Email not verified', 'Please verify your email address to access all features', 'error');
            user.sendEmailVerification();
            
            // Still allow login but show message
            setTimeout(() => {
              submitBtn.innerHTML = originalText;
              submitBtn.disabled = false;
              window.location.href = 'home.html';
            }, 1500);
          } else {
            // Successful login
            showToast('Welcome back!', 'Redirecting to your dashboard...');
            setTimeout(() => {
              window.location.href = 'home.html';
            }, 1500);
          }
        })
        .catch((error) => {
          // Handle errors
          let errorMessage = 'An error occurred during sign in';
          
          switch (error.code) {
            case 'auth/invalid-email':
              errorMessage = 'Invalid email address format';
              break;
            case 'auth/user-disabled':
              errorMessage = 'This account has been disabled';
              break;
            case 'auth/user-not-found':
              errorMessage = 'No account found with this email';
              break;
            case 'auth/wrong-password':
              errorMessage = 'Incorrect password';
              break;
            default:
              errorMessage = error.message;
          }
          
          showToast('Sign in failed', errorMessage, 'error');
          submitBtn.innerHTML = originalText;
          submitBtn.disabled = false;
        });
    }

    function handleRegister(e) {
      e.preventDefault();
      
      const name = document.getElementById('register-name').value;
      const email = document.getElementById('register-email').value;
      const password = document.getElementById('register-password').value;
      const confirmPassword = document.getElementById('register-confirm').value;
      const submitBtn = document.getElementById('register-submit');
      
      // Validate passwords match
      if (password !== confirmPassword) {
        showToast('Registration failed', 'Passwords do not match', 'error');
        return;
      }
      
      // Validate password length
      if (password.length < 6) {
        showToast('Registration failed', 'Password must be at least 6 characters', 'error');
        return;
      }
      
      // Show loading state
      const originalText = submitBtn.innerHTML;
      submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Creating account...';
      submitBtn.disabled = true;
      
      auth.createUserWithEmailAndPassword(email, password)
        .then((userCredential) => {
          const user = userCredential.user;
          
          // Update profile with display name
          return user.updateProfile({
            displayName: name
          }).then(() => {
            // Send email verification
            return user.sendEmailVerification();
          }).then(() => {
            // Create user document in Firestore
            return db.collection('users').doc(user.uid).set({
              displayName: name,
              email: email,
              createdAt: new Date(),
              lastLogin: new Date()
            });
          });
        })
        .then(() => {
          showToast('Account created', 'Please check your email to verify your account');
          
          // Redirect after delay
          setTimeout(() => {
            setAuthView('login');
          }, 2000);
        })
        .catch((error) => {
          // Handle errors
          let errorMessage = 'An error occurred during registration';
          
          switch (error.code) {
            case 'auth/email-already-in-use':
              errorMessage = 'This email is already registered';
              break;
            case 'auth/invalid-email':
              errorMessage = 'Invalid email address format';
              break;
            case 'auth/operation-not-allowed':
              errorMessage = 'Email/password accounts are not enabled';
              break;
            case 'auth/weak-password':
              errorMessage = 'Password is too weak';
              break;
            default:
              errorMessage = error.message;
          }
          
          showToast('Registration failed', errorMessage, 'error');
          submitBtn.innerHTML = originalText;
          submitBtn.disabled = false;
        });
    }

    function handleForgotPassword(e) {
      e.preventDefault();
      
      const email = document.getElementById('forgot-email').value;
      const submitBtn = document.getElementById('forgot-submit');
      
      // Show loading state
      const originalText = submitBtn.innerHTML;
      submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Sending...';
      submitBtn.disabled = true;
      
      auth.sendPasswordResetEmail(email)
        .then(() => {
          showToast('Reset email sent', 'Check your inbox for password reset instructions');
          
          // Return to login after delay
          setTimeout(() => {
            setAuthView('login');
          }, 2000);
        })
        .catch((error) => {
          // Handle errors
          let errorMessage = 'An error occurred while sending reset email';
          
          switch (error.code) {
            case 'auth/invalid-email':
              errorMessage = 'Invalid email address format';
              break;
            case 'auth/user-not-found':
              errorMessage = 'No account found with this email';
              break;
            default:
              errorMessage = error.message;
          }
          
          showToast('Failed to send', errorMessage, 'error');
          submitBtn.innerHTML = originalText;
          submitBtn.disabled = false;
        });
    }

    // --------- INITIALIZATION ----------
    function init() {
      // Initialize theme
      initTheme();
      
      // Set up event listeners for top buttons
      btnLogin.addEventListener('click', () => setAuthView('login'));
      btnRegister.addEventListener('click', () => setAuthView('register'));
      
      // Set up initial auth view
      setAuthView('login');
      
      // Check if user is already logged in
      auth.onAuthStateChanged((user) => {
        if (user && user.emailVerified) {
          // User is signed in and verified, redirect to home
          window.location.href = 'home.html';
        }
      });
    }

    // Start the application
    init();
  </script>
</body>
</html>